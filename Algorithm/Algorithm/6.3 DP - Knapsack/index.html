<!DOCTYPE html>
<!--[if lte IE 8 ]>
<html class="ie" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<!--<![endif]-->

<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><title>6.3 DP - Knapsack | Louie&#39;s Blog</title>
  <!-- Meta data -->
    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="Louie's Blog">
    <meta name="author" content="黄刘胤,Louie">
    <meta name="description" content="黄刘胤的博客 Louie's blog" />
    <meta name="keywords" content="黄刘胤,Louie,LouieHuang" />

    <!-- Favicon, (keep icon in root folder) -->
    <link rel="Shortcut Icon" href="/img/logo.ico" type="image/ico">

    <link rel="alternate" href="/atom.xml" title="Louie&#39;s Blog" type="application/atom+xml">
    <link rel="stylesheet" href="/css/all.css" media="screen" type="text/css">
	
    <link rel="stylesheet" href="/highlightjs/xcode.css" type="text/css">
    
    

    <!-- Custom stylesheet, (add custom styles here, always load last) -->
    <!-- Load our stylesheet for IE8 -->
    <!--[if IE 8]>
    <link rel="stylesheet" type="text/css" href="/css/ie8.css" />
    <![endif]-->

    <!-- Google Webfonts (Monserrat 400/700, Open Sans 400/600) -->
    <!--     
    <link href='//fonts.useso.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'>
    <link href='//fonts.useso.com/css?family=Open+Sans:400,600' rel='stylesheet' type='text/css'>
    -->
    <!-- 改为云存储 -->
    <!-- <link href='//gitimage-10031767.file.myqcloud.com/blog_image/Theme_Image/family%3DOpen%2BSans400%2C600.css' rel='stylesheet' type='text/css'> -->
    <!-- 或者本地也可以 -->
    <link href='/css/family=Open+Sans400,600.css' rel='stylesheet' type='text/css'>


    <!-- Load our fonts individually if IE8+, to avoid faux bold & italic rendering -->
    <!--[if IE]>
    <link href='http://fonts.useso.com/css?family=Montserrat:400' rel='stylesheet' type='text/css'>
    <link href='http://fonts.useso.com/css?family=Montserrat:700' rel='stylesheet' type='text/css'>
    <link href='http://fonts.useso.com/css?family=Open+Sans:400' rel='stylesheet' type='text/css'>
    <link href='http://fonts.useso.com/css?family=Open+Sans:600' rel='stylesheet' type='text/css'>
    <![endif]-->

    <!-- jQuery | Load our jQuery, with an alternative source fallback to a local version if request is unavailable -->
    <script src="/js/jquery-1.11.1.min.js"></script>
    <script>window.jQuery || document.write('<script src="js/jquery-1.11.1.min.js"><\/script>')</script>

    <!-- Load these in the <head> for quicker IE8+ load times -->
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="/js/html5shiv.min.js"></script>
    <script src="/js/respond.min.js"></script>
    <![endif]-->










  
  
  <link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="atom.xml">
  
  

  <!-- Baidu -->
  <!--
  
  -->

  <!-- google统计 -->
  
  <script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-76175499-1', 'auto');
  ga('send', 'pageview');
  </script>
  

  
  <style>.col-md-8.col-md-offset-2.opening-statement img{display:none;}</style><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>



<body id="index" class="lightnav animsition">

      <!-- hexo-inject:begin --><!-- hexo-inject:end --><!-- ============================ Off-canvas navigation =========================== -->

    <div class="sb-slidebar sb-right sb-style-overlay sb-momentum-scrolling">
        <div class="sb-close" aria-label="Close Menu" aria-hidden="true">
            <img src="/img/close.png" alt="Close"/>
        </div>
        <!-- header -->
        <div style="text-align:center;margin-top:15px;margin-bottom:-30px;">
            <img style="height:120px;weight:120px" src="/img/header.jpg" alt="Close"/>
            <h4 style="margin-top:10px;color:#fff;">黄刘胤 | Louie</h4>
        </div>
        <!-- Lists in Slidebars -->
        <ul class="sb-menu">
            <li><a href="/" class="animsition-link" title="Home">Home</a></li>
            <li><a href="/archives" class="animsition-link" title="archive">archives</a></li>
            <!-- Dropdown Menu -->
			 
            
        	<li>
        		<a class="sb-toggle-submenu">Categories<span class="sb-caret"></span></a>
            	<ul class="sb-submenu">
				  	
				    <li><a href="/categories/Algorithm/" class="animsition-link">Algorithm<small>(17)</small></a></li>
				    
				    <li><a href="/categories/Algorithm-Practice/" class="animsition-link">Algorithm Practice<small>(20)</small></a></li>
				    
				    <li><a href="/categories/Dynamic-Programming/" class="animsition-link">Dynamic Programming<small>(8)</small></a></li>
				    
				    <li><a href="/categories/Information-Retrieval/" class="animsition-link">Information Retrieval<small>(8)</small></a></li>
				    
				    <li><a href="/categories/Machine-Learning/" class="animsition-link">Machine Learning<small>(23)</small></a></li>
				    
				    <li><a href="/categories/Miscellaneous/" class="animsition-link">Miscellaneous<small>(9)</small></a></li>
				    
				    <li><a href="/categories/Project-Images/" class="animsition-link">Project Images<small>(9)</small></a></li>
				    
				    <li><a href="/categories/Recommender-System/" class="animsition-link">Recommender System<small>(8)</small></a></li>
				    
				</ul>
        	</li>
			
            
            <li>
                <a class="sb-toggle-submenu">Links<span class="sb-caret"></span></a>
                <ul class="sb-submenu">
                    
                    <li><a href="/Resume.pdf" class="animsition-link">Resume</a></li>
                    
                </ul>
            </li>
            
        </ul>
        <!-- Lists in Slidebars -->
        <ul class="sb-menu secondary">
            <li><a href="/about.html" class="animsition-link" title="about">About Me</a></li>
            <li><a href="/atom.xml" class="animsition-link" title="rss">RSS</a></li>
        </ul>
    </div>
    
    <!-- ============================ END Off-canvas navigation =========================== -->

    <!-- ============================ #sb-site Main Page Wrapper =========================== -->

    <div id="sb-site">
        <!-- #sb-site - All page content should be contained within this id, except the off-canvas navigation itself -->

        <!-- ============================ Header & Logo bar =========================== -->

        <div id="navigation" class="navbar navbar-fixed-top">
            <div class="navbar-inner">
                <div class="container">
                    <!-- Nav logo -->
                    <div class="logo">
                        <a href="/" title="Logo" class="animsition-link">
                         <img src="/img/logo.ico" alt="Logo" width="35px;"/> 
                        </a>
                    </div>
                    <!-- // Nav logo -->
                    <!-- Info-bar -->
                    <nav>
                        <ul class="nav">
                            <li><a href="/" class="animsition-link">Louie's Blog</a></li>
                            <li class="nolink"><span>Always </span>Thinking</li>
                            
                            <li><a href="https://github.com/louiehuang" title="Github" target="_blank"><i class="icon-github"></i></a></li>
                            
                            
                            <li><a href="http://weibo.com/" title="Twitter" target="_blank"><i class="icon-twitter"></i></a></li>
                            
                            
                            <li><a href="https://www.facebook.com/" title="Facebook" target="_blank"><i class="icon-facebook"></i></a></li>
                            
                            
                            <li><a href="https://google.com/" title="Google-Plus" target="_blank"><i class="icon-google-plus"></i></a></li>
                            
                            
                            
                            <li class="nolink"><span>Welcome!</span></li>
                        </ul>
                    </nav>
                    <!--// Info-bar -->
                </div>
                <!-- // .container -->
                <div class="learnmore sb-toggle-right">More</div>
                <button type="button" class="navbar-toggle menu-icon sb-toggle-right" title="More">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar before"></span>
                <span class="icon-bar main"></span>
                <span class="icon-bar after"></span>
                </button>
            </div>
            <!-- // .navbar-inner -->
        </div>

        <!-- ============================ Header & Logo bar =========================== -->

      
<section id="intro">
    <div class="container">
        <div class="row col-md-offset-2">
            <div class="col-md-8">
    			<span class="post-meta">
      <time datetime="2018-03-02T08:00:00.000Z" itemprop="datePublished">
          2018-03-02
      </time>
    
</span>
                <h1>6.3 DP - Knapsack</h1>
            </div>
        </div>
        <div class="col-md-8 col-md-offset-2">
      		<h2 id="Dynamic-Programming-Knapsack"><a href="#Dynamic-Programming-Knapsack" class="headerlink" title="Dynamic Programming - Knapsack"></a>Dynamic Programming - Knapsack</h2><h3 id="1-0-1-Knapsack"><a href="#1-0-1-Knapsack" class="headerlink" title="1. 0-1 Knapsack"></a>1. 0-1 Knapsack</h3><h4 id="1-1-Description"><a href="#1-1-Description" class="headerlink" title="1.1 Description"></a>1.1 Description</h4><p>Given n <strong>unique</strong> items,each with a <strong>weight</strong> and a <strong>value</strong>, determine the subset of items such that the total weight &lt;= a given capacity W, and the total value V is as large as possible. You cannot break an item, so you can either pick the complete item, or don’t pick it (0-1 property).</p>
<p>(The fractional knapsack problem can be solved by a greedy algorithm. But 0-1 knapsack cannot)</p>
<p>For example, we have W = 10, and items:</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">Item</th>
<th style="text-align:center">Weight</th>
<th style="text-align:center">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">6</td>
<td style="text-align:center">30</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">4</td>
<td style="text-align:center">14</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">1</td>
<td style="text-align:center">9</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">2</td>
<td style="text-align:center">12</td>
</tr>
</tbody>
</table>
</div>
<p>Using greedy, we may choose item 1 and 2, thus have total value = 30+14, but in fact, we could choose item 1,3,4 thus have total value = 30+9+12.</p>
<h4 id="1-2-Solution"><a href="#1-2-Solution" class="headerlink" title="1.2 Solution"></a>1.2 Solution</h4><p>Use $x_{k}$ to denote item k, if we choose it, $x_k=1$, otherwise, $x_k=0$, then for 0-1 Knapsack Problem, we are essentially trying to:</p>
<script type="math/tex; mode=display">\left\{\begin{aligned}maximize \sum_{k=1}^{n}v_{k}x_{k}  \\\sum_{k=1}^{n}w_{k}x_{k} \le W\end{aligned}\right.</script><p>Let <code>dp[k, w]</code> be the maximum value we can achieve by using a knapsack of capacity $w \in [0,W]$ and with $k \in [1,n]$ items.</p>
<p>Consider the $k^{th}$ item, we either choose it or not. </p>
<blockquote>
<ol>
<li>If we choose the $k^{th}$ item, $dp[k, w] = dp[k-1, w-w_k] + v_k$, we can think $w-w_k$ as making room for the $k^{th}$ item, so the total weight for the first $(k-1)$ items is $w-w_k$.</li>
</ol>
<ol>
<li>If we do not choose the $k^{th}$ item, then $dp[k,w] = dp[k-1,w]$. </li>
</ol>
</blockquote>
<p>We just pick the bigger value of these two possible choices. Also notice that when current available capacity is <strong>not enough</strong> for current item, i.e $w_k &lt; w$, we cannot put it in, so in this case, $dp[k,w] = dp[k-1,w]$.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//return maximum value achievable</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">zeroOneKnapsack</span><span class="params">(<span class="keyword">int</span>[] val, <span class="keyword">int</span>[] wt, <span class="keyword">int</span> n, <span class="keyword">int</span> W)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span>[][] dp = <span class="keyword">new</span> <span class="keyword">int</span>[n+<span class="number">1</span>][W+<span class="number">1</span>];</span><br><span class="line">    <span class="comment">//fill in the table row by row</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= n; k++)&#123; <span class="comment">//use the fisrt item, notice that shoulbe be (val[k-1], wt[k-1])</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> w = <span class="number">0</span>; w &lt;= W; w++)&#123; <span class="comment">//cannot start from wt[k-1]!!!</span></span><br><span class="line">            <span class="keyword">if</span>(wt[k-<span class="number">1</span>] &gt; w)</span><br><span class="line">                dp[k][w] = dp[k-<span class="number">1</span>][w];</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                dp[k][w] = Math.max(dp[k-<span class="number">1</span>][w-wt[k-<span class="number">1</span>]] + val[k-<span class="number">1</span>], dp[k-<span class="number">1</span>][w]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dp[n][W];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>In the implementation above, be careful about the <code>for-loop</code> for updating <code>w</code>, we need to start from 0, try all valid capacity, check $wt[k-1] \gt w$ explictly: </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> w = <span class="number">0</span>; w &lt;= W; w++)&#123; <span class="comment">//cannot start from wt[k-1]!!!</span></span><br><span class="line">    <span class="keyword">if</span>(wt[k-<span class="number">1</span>] &gt; w)</span><br><span class="line">        dp[k][w] = dp[k-<span class="number">1</span>][w];</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        dp[k][w] = Math.max(dp[k-<span class="number">1</span>][w-wt[k-<span class="number">1</span>]] + val[k-<span class="number">1</span>], dp[k-<span class="number">1</span>][w]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>This means we <strong>cannot</strong> code like this, start w from <code>wt[k-1]</code>. <strong>Otherwiese, $dp[k][w]$ for w &lt; wk[k-1] will end up with value 0 since we never update them.</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> w = wt[k-<span class="number">1</span>]; w &lt;= W; w++) <span class="comment">//this is wrong!</span></span><br><span class="line">	dp[k][w] = Math.max(dp[k-<span class="number">1</span>][w-wt[k-<span class="number">1</span>]] + val[k-<span class="number">1</span>], dp[k-<span class="number">1</span>][w]);</span><br></pre></td></tr></table></figure>
<p>In the next optimization section, we use one-dimensional array, and we can use $wt[k-1]$, (<code>for(int w = W; i &gt;= wt[k-1]; w--</code>), but here we cannot do that. Because what <code>if(wt[k-1] &gt; w)</code> statement means is that if current capacity is not enough, we do not choose kth item, but use <strong>previous</strong> result (k-1 items), in the two-dimensional array <code>dp[][]</code>, which is 1 cell position above it, we should copy that value down, so <code>dp[k][w] = dp[k-1][w]</code>, but if we just start w from <code>wk[k-1]</code>, we miss the case that <code>wk[k-1] &lt; w</code>, thus <code>dp[k][w]</code> will remain as <code>0</code> instead of being updated to <code>dp[k-1][w]</code>.</p>
<p>For example, <code>val = {30,14,9,12}</code>, <code>wt = {6,4,1,2}</code>, <code>W = 10</code>, when k = 4, w = 1 (consider whether item 3 should be put into the knapsack with capacity 1), look at <code>dp[4][1]</code> below, what should this <code>?</code> be? It should be <strong>9</strong> (<code>dp[3][1]</code>), but if we start w from <code>wt[k-1] = wt[3] = 2 &gt; 1 = w</code>, it will remain as the <strong>default <code>0</code></strong> since we never run into the <code>for-loop</code> to update it. </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">0	0	0	0	0	0	0	0	0	0	0	</span><br><span class="line">0	0	0	0	0	0	30	30	30	30	30	</span><br><span class="line">0	0	0	0	14	14	30	30	30	30	44	</span><br><span class="line">0	9	9	9	14	23	30	39	39	39	44	</span><br><span class="line">0	?	12	21	21	23	30	39	42	51	51</span><br></pre></td></tr></table></figure>
<p>(If we are using one-dimensional array <code>dp[]</code>, when k = 4, now the <code>?</code> is 9 not 0, since we overwrite this <code>dp[]</code> each time, <strong>from right to left</strong>)</p>
<ul>
<li>Time complexity: $O(nW)$</li>
<li>Space complexity: $O(nW)$</li>
</ul>
<p>This is <font color="red"><strong>pseudo-polynomial</strong></font> algorithm, it depends on the value of W, which could be much bigger than n.</p>
<p>A numeric algorithm runs in pseudo-polynomial time if its running time is polynomial in the numeric value of the input, but is exponential in the length of the input.</p>
<p><br></p>
<h4 id="1-3-Optimization-using-a-one-dimensional-array"><a href="#1-3-Optimization-using-a-one-dimensional-array" class="headerlink" title="1.3 Optimization - using a one-dimensional array"></a>1.3 Optimization - using a one-dimensional array</h4><p>We can reduce space complexity from $O(nW)$ to $O(W)$. In the implementation above, we record all status for each item k, but this is not necessary, we can <strong>overwrite</strong> previous result, i.e. in the $k^{th}$ round, we overwrite the result of the $(k-1)^{th}$ round. </p>
<p>This means we need to make sure that in the $k^{th}$ round, the value <code>dp[w]</code> before updating is the result in the $(k-1)^{th}$  round. To achieve this goal, we can <strong>decrease</strong> <code>w</code> from <code>W</code> instead of increasing it. If we still increase <code>w</code>, then <code>dp[w-wt[k]]</code> is the value updated in the $k^{th}$ round (corrsponds to <code>dp[k,w-wt[k]]</code>) rather than in routhe $(k-1)^{th}$  round (corrsponds to <code>dp[k-1,w-wt[k]]</code>) .  </p>
<p>Since we overwrite the array, <code>w</code> can be stopped at <code>wt[k]</code> instead of <code>0</code>, we have <code>for(int w = W; w &gt;= wt[k]; w--)</code>.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">knapSack</span><span class="params">(<span class="keyword">int</span>[] val, <span class="keyword">int</span>[] wt, <span class="keyword">int</span> n, <span class="keyword">int</span> W)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span>[] dp = <span class="keyword">new</span> <span class="keyword">int</span>[W+<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; n; k++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> w = W; w &gt;= wt[k]; w--) <span class="comment">//start from W, then decrement, we can stop at wt[k]</span></span><br><span class="line">            dp[w] = Math.max(dp[w-wt[k]] + val[k], dp[w]);</span><br><span class="line">    <span class="keyword">return</span> dp[W];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="1-4-Constructing-the-Optimal-Solution"><a href="#1-4-Constructing-the-Optimal-Solution" class="headerlink" title="1.4 Constructing the Optimal Solution"></a>1.4 Constructing the Optimal Solution</h4><p>(It seems that we cannot construct the optimal solution efficiently if using a one-dimensional array)</p>
<p><br></p>
<p>To compute the actual subset $T$, we can use an auxiliary boolean array $keep[k, w]$ whose value is 1 if we<br>decide to take the $k^{th}$ item and 0 otherwise. So we can backtrack this array to output the answer.</p>
<blockquote>
<ol>
<li>If $keep[k,w]$ is 1, then item k belongs to $T$, we then check $keep[k-1, W-w_k]$</li>
<li>If $keep[k,w]$ is 0, then item k does not belong to $T$, we then check $keep[k-1, W]$</li>
</ol>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">knapsackWithSolution</span><span class="params">(<span class="keyword">int</span>[] val, <span class="keyword">int</span>[] wt, <span class="keyword">int</span> n, <span class="keyword">int</span> W)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span>[][] dp = <span class="keyword">new</span> <span class="keyword">int</span>[n + <span class="number">1</span>][W + <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">int</span>[][] keep = <span class="keyword">new</span> <span class="keyword">int</span>[n + <span class="number">1</span>][W + <span class="number">1</span>]; <span class="comment">//record result</span></span><br><span class="line">    <span class="comment">// fill in the table row by row</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= n; k++) &#123; <span class="comment">// use the fisrt item, which is val[k-1]</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> w = <span class="number">0</span>; w &lt;= W; w++) &#123; <span class="comment">// cannot start from wt[k-1]!!!</span></span><br><span class="line">            <span class="keyword">if</span> (wt[k - <span class="number">1</span>] &lt;= w &amp;&amp; dp[k - <span class="number">1</span>][w - wt[k - <span class="number">1</span>]] + val[k - <span class="number">1</span>] &gt; dp[k - <span class="number">1</span>][w])&#123;</span><br><span class="line">                dp[k][w] = dp[k - <span class="number">1</span>][w - wt[k - <span class="number">1</span>]] + val[k - <span class="number">1</span>];</span><br><span class="line">                keep[k][w] = <span class="number">1</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                dp[k][w] = dp[k - <span class="number">1</span>][w];</span><br><span class="line">                keep[k][w] = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    System.out.print(<span class="string">"Solution(item index): "</span>);</span><br><span class="line">    <span class="keyword">int</span> weight = W;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = n; i &gt;= <span class="number">1</span>; i--)&#123;</span><br><span class="line">        <span class="keyword">if</span>(keep[i][weight] == <span class="number">1</span>)&#123;</span><br><span class="line">            System.out.print((i-<span class="number">1</span>) + <span class="string">" "</span>);</span><br><span class="line">            weight -= wt[i-<span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="1-5-More-thought-some-details-about-initialization"><a href="#1-5-More-thought-some-details-about-initialization" class="headerlink" title="1.5 More thought - some details about initialization"></a>1.5 More thought - some details about initialization</h4><blockquote>
<ol>
<li>Sometimes we are required to fill up the knapsack ($\sum_{k=1}^{n}w_kx_k = W$, The total weight of items we choose should be <strong>equal</strong> to W). </li>
<li>Sometimes we do not have this requirement, we are just told to maximize the total value. (Like this classical 0-1 knapsack problem)</li>
</ol>
</blockquote>
<p>In the first case, we <strong>initialize $dp[0]$ to $0$, and $dp[1,…W]$ to $-\infty$.</strong> </p>
<p>Initializing this way, we can guarantee that the solution we find is one of the optimal solutions that satisfies $\sum_{k=1}^{n}w_kx_k = W$. </p>
<p>For example, we will find {0,1} for the following input, thus have total value = 30+14=44. (We have {0,1} and {0,4} that can form total weight = 10, but first one has value 44, the second has value 35)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">int W = 10;</span><br><span class="line">int[] val = &#123; 30, 14, 9, 12, 5&#125;;</span><br><span class="line">int[] wt = &#123; 6, 4, 1, 2, 4&#125;;</span><br></pre></td></tr></table></figure>
<p><strong>Why this initialization works?</strong> </p>
<p><strong>We can regard <code>dp</code> array as the valid status when knapsack has no items in it.</strong> So if the knapsack needs to be filled to full ($\sum_{k=1}^{n}w_kx_k = W$), <strong>only the knapsack with capacity <code>w=0</code> can be “full” when there is no item in it.</strong> (I mean, you can not make a knapsack with capacity &gt; 0 be full without putting anything into it.) All other capacityies do not have valid solution. These are “undefined” statuses, so we assign them with $-\infty$.</p>
<p>If the knapsack is not required to be full, then a knapsack with any capacity has a valid solution - “We put nothing into the knapsack”. This solution’s value is 0, so we initialize $dp[0…W]$  to $0$.</p>
<p><br></p>
<h3 id="2-Unbounded-Knapsack-Problem"><a href="#2-Unbounded-Knapsack-Problem" class="headerlink" title="2. Unbounded Knapsack Problem"></a>2. Unbounded Knapsack Problem</h3><h4 id="2-1-Description"><a href="#2-1-Description" class="headerlink" title="2.1 Description"></a>2.1 Description</h4><p>Given n kinds items,each with a <strong>weight</strong> and a <strong>value</strong> determine the subset of items such that the total weight &lt;= a given capacity W, and the total value V is as large as possible. <strong>Here, we are allowed to use unlimited number of instances of an item.</strong> </p>
<p>For example,</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Input : W = 100</span><br><span class="line">        val[]  = &#123;1, 30&#125;</span><br><span class="line">        wt[] = &#123;1, 50&#125;</span><br><span class="line">Output : 100</span><br><span class="line">(We choose the first kind of item 100 times.)</span><br></pre></td></tr></table></figure>
<h4 id="2-2-A-simple-idea-O-nW-sum-frac-W-w-k"><a href="#2-2-A-simple-idea-O-nW-sum-frac-W-w-k" class="headerlink" title="2.2 A simple idea - $O(nW\sum{\frac{W}{w_k}})$"></a>2.2 A simple idea - $O(nW\sum{\frac{W}{w_k}})$</h4><p>The difference between Unbounded Knapsack Problem and 0-1 Knapsack Problem is that here <strong>we can choose an item many times.</strong> </p>
<p>An naive thought towards this problem is that we try all possiblities that an item $k$ can be chosen (It can be chosen $[0, \lfloor\frac{w}{w_k}\rfloor]$ times, where w is current available capacity, initially W.</p>
<p>Use notation $dp[k,w]$ to represent the optimal value using a knapsack of capacity $0 \le w \le W$ and with first $k$ kinds of items, $1\le k\le n$.</p>
<ul>
<li>If we do not take item $k$, $dp[k,w] = dp[k-1, w]$</li>
<li>If we do take item $k$, $dp[k,w] = max{dp[k-1, w-cw<em>k] + cv_k}$, where $0 \le cw</em>{k} \le w$, i.e.  $0 \le c \le \lfloor\frac{W}{w_k}\rfloor$</li>
</ul>
<p>So our recurrence relation is: </p>
<script type="math/tex; mode=display">dp[k,w] = max\{dp[k-1, w], max\{dp[k-1, w-cw_k] + cv_k\}\}</script><p>Time complexity for this will be $O(nW\sum{\frac{W}{w_k}})$. But we can do some pruning: if $v_i &gt; v_j$ &amp;&amp; $w_i &lt; w_j$, then we do not have to consider item $j$.</p>
<h4 id="2-3-Solution-O-nW"><a href="#2-3-Solution-O-nW" class="headerlink" title="2.3 Solution - O(nW)"></a>2.3 Solution - O(nW)</h4><p>In <code>0-1 knapsack problem</code>, we came up with the solution:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">knapSack</span><span class="params">(<span class="keyword">int</span>[] val, <span class="keyword">int</span>[] wt, <span class="keyword">int</span> n, <span class="keyword">int</span> W)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span>[] dp = <span class="keyword">new</span> <span class="keyword">int</span>[W+<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; n; k++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> w = W; w &gt;= wt[k]; w--) <span class="comment">//start from W, then decrement, we can stop at wt[k]</span></span><br><span class="line">            dp[w] = Math.max(dp[w-wt[k]] + val[k], dp[w]);</span><br><span class="line">    <span class="keyword">return</span> dp[W];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>We can slightly modify this solution to solve this Unbounded Knapsack Problem:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">unboundedKnapsack</span><span class="params">(<span class="keyword">int</span>[] val, <span class="keyword">int</span>[] wt, <span class="keyword">int</span> n, <span class="keyword">int</span> W)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span>[] dp = <span class="keyword">new</span> <span class="keyword">int</span>[W+<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; n; k++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> w = wt[k]; w &lt;= W; w++) <span class="comment">//start from wt[t], then increment</span></span><br><span class="line">            dp[w] = Math.max(dp[w-wt[k]] + val[k], dp[w]);</span><br><span class="line">    <span class="keyword">return</span> dp[W];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>As you can see, the only difference between these two solution is just <strong>the order of the inner <code>for-loop</code>.</strong></p>
<p>So, why could this solution work? Let’s first review why in <code>0-1 Knapsack Problem</code> we decrement <code>w</code>. The purpose of decreasing <code>w</code> is to make sure that in the $k^{th}$ round, status <code>dp[k,w]</code> comes from <code>dp[k-1, w-w[k]]</code>. <strong>In other words, this is to make sure that each item can only be chosen once.</strong>  </p>
<p>But now, our <code>Unbounded Knapsack Problem</code> does not have this requirement, so when considering “adding the $k^{th}$ kind of item”, we also need to consider the sub-result that we have already chosen the first $k^{th}$ kind of item, which is<code>dp[k, w-w[k]]</code>. That’s why we can increment w here. </p>
<p>We can also switch the two <code>for-loop</code>s in the solution, like this:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">unboundedKnapsack</span><span class="params">(<span class="keyword">int</span>[] val, <span class="keyword">int</span>[] wt, <span class="keyword">int</span> n, <span class="keyword">int</span> W)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span>[] dp = <span class="keyword">new</span> <span class="keyword">int</span>[W+<span class="number">1</span>];</span><br><span class="line">    <span class="comment">//think for each capacity w, try to put all </span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> w = <span class="number">0</span>; w &lt;= W; w++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; n; k++)</span><br><span class="line">            <span class="keyword">if</span>(wt[k] &lt;= w)</span><br><span class="line">                dp[w] = Math.max(dp[w-wt[k]] + val[k], dp[w]);</span><br><span class="line">    <span class="keyword">return</span> dp[W];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>If we write down the <code>Unbounded Knapsack Problem</code>‘s transition equation explicitly, we’ll have:</p>
<script type="math/tex; mode=display">dp[k, w] = max\{dp[k-1, w], dp[k, w-w_k] + v_k\}</script><p>Implement this with one-dimentional array, we can also have the two implementations above. (The first one is to fill in the table row by row, the second one is to fill in the table column by column)</p>
<p>To compare, <code>0-1 Knapsack Problem</code>, we have:</p>
<script type="math/tex; mode=display">dp[k, w] = max\{dp[k-1, w], dp[k-1, w-w_k] + v_k\}</script>
            <div class="clearfix"></div>
            <hr class="nogutter">
        </div>
        <nav class="pagination" role="pagination">
    
    <a class="pull-left" href="/Dynamic-Programming/Dynamic Programming/05_FormPalindromeI(Deletion)/" style="float: left;">
        ← 05 Form a palindrome I (Deletion)
    </a>
    
    
    <a class="pull-right" href="/Dynamic-Programming/Dynamic Programming/04_LongestCommonSubsequence/">
        04 Longest Common Subsequence →
    </a>
    
</nav>

        <!-- not using this
            <div class="duoshuo">
<div class="ds-thread" data-thread-key="Algorithm/Algorithm/6.3 DP - Knapsack/" data-title="6.3 DP - Knapsack" data-url="http://louie.link/Algorithm/Algorithm/6.3 DP - Knapsack/"></div>
<script type="text/javascript">
var duoshuoQuery = {short_name:"louiehuang"};
(function() {
	var ds = document.createElement('script');
	ds.type = 'text/javascript';ds.async = true;
	ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
	ds.charset = 'UTF-8';
	(document.getElementsByTagName('head')[0] 
	 || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script>
</div>
        -->
    </div>
</section>


      
<!-- ============================ Footer =========================== -->

<footer>
    <div class="container">
            <div class="copy">
                <p>
                    &copy; 2015<script>new Date().getFullYear()>2010&&document.write("-"+new Date().getFullYear());</script>, Content By 黄刘胤,Louie. All Rights Reserved.
                </p>
                <p>Theme By Kieran</p>
            </div>
            <div class="social">
                <ul>
                    
                    <li><a href="https://github.com/louiehuang" title="Github" target="_blank"><i class="icon-github"></i></a>&nbsp;</li>
                    
                    
                    <li><a href="http://weibo.com/" title="Twitter" target="_blank"><i class="icon-twitter"></i></a>&nbsp;</li>
                    
                    
                    <li><a href="https://www.facebook.com/" title="Facebook" target="_blank"><i class="icon-facebook"></i></a>&nbsp;</li>
                    
                    
                    <li><a href="https://google.com/" title="Google-Plus" target="_blank"><i class="icon-google-plus"></i></a>&nbsp;</li>
                    
                    
                </ul>
            </div>
            <div class="clearfix"> </div>
        </div>
</footer>

<!-- ============================ END Footer =========================== -->
      <!-- Load our scripts -->
        
<!-- Resizable 'on-demand' full-height hero -->
<script type="text/javascript">
    
    var resizeHero = function () {
        var hero = $(".cover,.heightblock"),
            window1 = $(window);
        hero.css({
            "height": window1.height()
        });
    };
    
    resizeHero();
    
    $(window).resize(function () {
        resizeHero();
    });
</script>
<script src="/js/plugins.min.js"></script><!-- Bootstrap core and concatenated plugins always load here -->
<script src="/js/jquery.flexslider-min.js"></script><!-- Flexslider plugin -->
<script src="/js/scripts.js"></script><!-- Theme scripts -->

<!-- Initiate flexslider plugin -->
<script type="text/javascript">
    $(document).ready(function($) {
      $('.flexslider').flexslider({
        animation: "fade",
        prevText: "",
        nextText: "",
        directionNav: true
      });
    });
</script>

<!-- post to baidu -->
<!-- not using this
    <script type="text/javascript">
    (function(){
        var bp = document.createElement('script');
        bp.src = '//push.zhanzhang.baidu.com/push.js';
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
    </script>
--><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->

</body>
</html>
